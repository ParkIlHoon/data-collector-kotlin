# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

orbs:
  gradle: circleci/gradle@3.0.0

executors:
  docker-executor:
    resource_class: medium
    docker:
      - image: eclipse-temurin:17-jdk
        auth:
          # ensure you have first added these secrets
          # visit app.circleci.com/settings/project/github/ParkIlHoon/data-collector/environment-variables
          username: $DOCKER_HUB_USER
          password: $DOCKER_HUB_PASSWORD

# Invoke jobs via workflows
# See: https://circleci.com/docs/2.0/configuration-reference/#workflows
workflows:
  docker-image-build-workflow:
    jobs:
      - gradle/run:
          name: Build
          executor: docker-executor
      - gradle/run:
          name: JIB push
          executor: docker-executor
          command: jib
          filters:
            branches:
              only:
                - master
          requires:
            - Build